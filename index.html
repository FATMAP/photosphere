<!DOCTYPE html>
<html lang="en">
<head>
	<title>Photosphere</title>
	<style>
		body { margin: 0; overflow: hidden; background-color: #000; }
		#sphere {width: 800px; height:600px; padding-left: 100px; padding-top: 50px;}
	</style>
	<script src="js/three.js"></script>
	<script src="js/CameraControls.js"></script>
	<script src="js/Detector.js"></script>
</head>
<body>
	<div id="sphere"></div>
	<script>
		var textureURLs = [  // URLs of the six faces of the cube map 
			"Sunny2/Sunny2_posx.png",
			"Sunny2/Sunny2_negx.png",
			"Sunny2/Sunny2_posz.png",
			"Sunny2/Sunny2_negz.png",
			"Sunny2/Sunny2_negy.png",
			"Sunny2/Sunny2_posy.png"
		];

		var cube;

		var textures = loadTextures(textureURLs, render);
		var materials = [];
		for (var i = 0; i < 6; i++) {
			materials.push( new THREE.MeshBasicMaterial( {
				color: "white",
				side: THREE.BackSide,  // IMPORTANT: To see the inside of the cube, back faces must be rendered!
				map: textures[i]
			} ) );
		}
		cube = new THREE.Mesh( new THREE.CubeGeometry(100,100,100), new THREE.MeshFaceMaterial(materials) );




		var webglEl = document.getElementById('sphere');

		var width  = webglEl.offsetWidth;
			height = webglEl.offsetHeight;

		var scene = new THREE.Scene();

		var camera = new THREE.PerspectiveCamera(60, width / height, 1, 1000);
		camera.position.x = 0.1;

		var renderer = Detector.webgl ? new THREE.WebGLRenderer() : new THREE.CanvasRenderer();
		renderer.setSize(width, height);

		window.sphere = new THREE.Mesh(
			new THREE.SphereGeometry(100, 20, 20),
			new THREE.MeshBasicMaterial({
				map: THREE.ImageUtils.loadTexture('index.jpg')
			})
		);
		sphere.quaternion.setFromEuler(new THREE.Euler(Math.PI / 2, 0, 0));
		sphere.scale.x = -1;
		// scene.add(sphere);

		cube.quaternion.setFromEuler(new THREE.Euler(Math.PI / 2, 0, 0));
		scene.add(cube);

		var controls = new CameraControls(webglEl, camera);

		webglEl.appendChild(renderer.domElement);

		render();

		function render() {
			controls.update();
			requestAnimationFrame(render);
			renderer.render(scene, camera);
		}
		
		function loadTextures(textureURLs, callback) {
			var loaded = 0;
			function loadedOne() {
				loaded++;
				if (callback && loaded == textureURLs.length) {
					for (var i = 0; i < textureURLs; i++)
						textures[i].needsUpdate = true;
					callback();
				}
			}
			var textures = [];
			for (var i = 0; i < textureURLs.length; i++) {
				var tex = THREE.ImageUtils.loadTexture( textureURLs[i], undefined, loadedOne );
				textures.push(tex);
			}
			return textures;
		}
	</script>
</body>
</html>
